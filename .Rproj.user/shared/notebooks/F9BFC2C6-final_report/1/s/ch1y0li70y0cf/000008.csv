"0","            ## it indeed is"
"0","      "
"0","                  ## Monte-Carlo simulation"
"0","            ## is there a significant difference in protein mass?"
"0","      # code can be used for things other than mass"
"0","      set.seed(1)"
"0","      # sample size"
"0","      Ns <- seq(5, 350, 20)"
"0","      lengthNs = length(Ns)"
"0","      # number of simulations"
"0","      B = 1000"
"0","      # function which takes samples and does Wilcox test"
"0","      simulation = function(n){  "
"0","       # x = cbind( matrix(sample(SwissProt_not_IMEX, B*n),B,n)"
"0","       # y = matrix(sample(SwissProt_and_IMEX, B*n),B,n)"
"0","       # genefilter::rowttests()"
"0","        wilcox.test.rr = matrix(0, 1, 3)"
"0","        x = sample(SwissProt_not_IMEX, n)"
"0","        y = sample(SwissProt_and_IMEX, n)"
"0","        wilcox.test.rr[1,c(1,2)] = wilcox.test(x, y, conf.int = T)$conf.int"
"0","        wilcox.test.rr[1,3] = wilcox.test(x, y, conf.int = T)$p.value"
"0","        return(wilcox.test.rr)"
"0","      }"
"0","      wilcox.test.rr = matrix(0, lengthNs, 3)"
"0","      # looping Monte-Carlo over samples sizes ]"
"0","     # for (n in 1:lengthNs) {"
"0","     #   z =replicate(B, simulation(Ns[n]), simplify = T)"
"0","     #   wilcox.test.rr[n,] = rowMeans(z)"
"0","     # }"
"0","      xx =cbind(wilcox.test.rr, Ns)"
"0","      qplot(xx[,4], xx[,3], ylab = ""Wilcox test p-val"", xlab = ""proteins sampled, N"")"
